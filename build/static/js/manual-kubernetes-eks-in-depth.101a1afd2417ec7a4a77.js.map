{"version":3,"sources":["/Users/dennis.okeeffe/Project-Imposter/developer-notes/manual/Kubernetes/EKS-In-Depth.md"],"names":["layoutProps","MDXLayout","MDXContent","_ref","components","props","Object","_Users_dennis_okeeffe_Project_Imposter_developer_notes_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","_mdx_js_react__WEBPACK_IMPORTED_MODULE_2__","assign","mdxType","id","parentName","alt","src","href","isMDXComponent"],"mappings":"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","file":"static/js/manual-kubernetes-eks-in-depth.de99743b.js","sourcesContent":["/* @jsx mdx */\n  import React from 'react'\n  import { mdx } from '@mdx-js/react'\n  /* @jsx mdx */\n\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"eks-in-depth\"\n    }}>{`EKS in Depth`}</h1>\n    <p>{`This is more of a basic theory section to understand how EKS works.`}</p>\n    <h2 {...{\n      \"id\": \"pricing\"\n    }}>{`Pricing`}</h2>\n    <p>{`USD$0.20 per hours for each EKS cluster you make. That's ~USD$144/month.`}</p>\n    <p>{`You pay normally for all the other resources related to running your apps:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Worker nodes (EC2)`}</li>\n      <li parentName=\"ul\">{`EBS volumes`}</li>\n      <li parentName=\"ul\">{`Network traffic`}</li>\n      <li parentName=\"ul\">{`Load balancers`}</li>\n    </ul>\n    <p>{`Check online for if pricing ever changes.`}</p>\n    <h2 {...{\n      \"id\": \"eks-control-place\"\n    }}>{`EKS Control Place`}</h2>\n    <p>{`The control plane sets up the cluster to be highly available (in 3 availability zones).`}</p>\n    <p>{`Each AZ will have a master node and etcd that is AWS managed. The workers nodes are what we supply.`}</p>\n    <p>{`Our local `}<inlineCode parentName=\"p\">{`kubectl`}</inlineCode>{` will talk directly to EKS.`}</p>\n    <h3 {...{\n      \"id\": \"under-the-hood\"\n    }}>{`Under the hood`}</h3>\n    <p><img alt=\"Under the hood\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548213794/eks-course/Screen_Shot_2019-01-23_at_2.22.40_pm.png\" /></p>\n    <ul>\n      <li parentName=\"ul\">{`Single tenant (you do not share it with other customers)`}</li>\n      <li parentName=\"ul\">{`Made of native AWS component (EC2, ELB, ASG, NLB, VPC)`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"eks-networking\"\n    }}>{`EKS Networking`}</h2>\n    <p><img alt=\"Network\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548213958/eks-course/Screen_Shot_2019-01-23_at_2.25.49_pm.png\" /></p>\n    <p>{`Recommended to have:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Private subnets: containers all the worker nodes to have application deployed. Must be large CIDR.`}</li>\n      <li parentName=\"ol\">{`Public subnets: Will contain any internet-facing load balancer to expose the applications.`}</li>\n      <li parentName=\"ol\">{`The VPC must have DNS hostname and DNS resolution support, otherwise nodes can't register.`}</li>\n    </ol>\n    <h3 {...{\n      \"id\": \"security-groups\"\n    }}>{`Security groups`}</h3>\n    <p><img alt=\"Security groups explored\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548214249/eks-course/Screen_Shot_2019-01-23_at_2.30.35_pm.png\" /></p>\n    <p>{`You have 2 security groups: `}<inlineCode parentName=\"p\">{`Control Plane`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`Worker Nodes`}</inlineCode>{`.`}</p>\n    <p>{`Read up on `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/freach/kubernetes-security-best-practice\"\n      }}>{`https://github.com/freach/kubernetes-security-best-practice`}</a>{`.`}</p>\n    <h3 {...{\n      \"id\": \"eks-pod-networking\"\n    }}>{`EKS Pod Networking`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`Amazon VPC CNI plugin: each pod receivers 1 IP address (=ENI => Elastic Network Interface) in VPC.`}</li>\n      <li parentName=\"ul\">{`Pods have the same IP address inside the EKS cluster and outside of it.`}</li>\n      <li parentName=\"ul\">{`Subnet limitations: CIRD /24 is 254 IP, not enough to run a lot of pods. You'll need a way bigger CIDR. Recommended is a CIDR /18.`}</li>\n      <li parentName=\"ul\">{`EC2 limitations: limited to amount of ENI/IP addresses it can have. Based on the network types, AWS has documentation on EC2 limits for ENIs, IPv4s and IPv6s.`}</li>\n    </ul>\n    <p>{`See `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html\"\n      }}>{`https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html`}</a>{` for more information on ENI limits.`}</p>\n    <h3 {...{\n      \"id\": \"network-security-with-calico\"\n    }}>{`Network security with Calico`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`Security groups allow all worker nodes to communicate to each other on any ports.`}</li>\n      <li parentName=\"ul\">{`This may be a problem if you want to segement applications, tenants or environments.`}</li>\n      <li parentName=\"ul\">{`You can use the Calico project instead of AWS Security Groups in this case.`}</li>\n      <li parentName=\"ul\">{`Network policies are directly assigned to pods (instead of worker nodes).`}</li>\n      <li parentName=\"ul\">{`More granular.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"iam-and-rbac-integration\"\n    }}>{`IAM and RBAC Integration`}</h3>\n    <p><img alt=\"IAM and RBAC in action\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548215421/eks-course/Screen_Shot_2019-01-23_at_2.50.02_pm.png\" /></p>\n    <p>{`Note: RBAC means \"Role-Based-Access-Control\".`}</p>\n    <ul>\n      <li parentName=\"ul\">{`When you talk to Kubernetes, authentication is held by IAM.`}</li>\n      <li parentName=\"ul\">{`Authorization is done by Kubernetes RBAC (native auth for K8s).`}</li>\n      <li parentName=\"ul\">{`Done through collaboration between AWS and Heptio.`}</li>\n      <li parentName=\"ul\">{`You can assign RBAC directly through IAM entities.`}</li>\n      <li parentName=\"ul\">{`By default, the role you assign to your K8s cluster has system:master permissions.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"k8s-worker-nodes\"\n    }}>{`K8s Worker Nodes`}</h3>\n    <p><img alt=\"K8s Worker Nodes\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548216415/eks-course/Screen_Shot_2019-01-23_at_3.06.44_pm.png\" /></p>\n    <ul>\n      <li parentName=\"ul\">{`When the join the cluster, they are assigned an IAM role and authorized in RBAC to join `}<inlineCode parentName=\"li\">{`system:bootstrappers`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`system: nodes`}</inlineCode>{` in your ConfigMap.`}</li>\n    </ul>\n    <p>{`You can write your own rules in the ConfigMap.`}</p>\n    <h3 {...{\n      \"id\": \"eks-load-balancers\"\n    }}>{`EKS Load Balancers`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`EKS support `}<inlineCode parentName=\"li\">{`Classic Load Balancer`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`Application Load Balancer`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`Network Load Balancer`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`Classic and Network Load Balancer is for Service of type `}<inlineCode parentName=\"li\">{`LoadBalancer`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`Application Load Balancer is for Ingress Controller.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"loadbalancer\"\n    }}>{`LoadBalancer`}</h3>\n    <p>{`Through the service of type `}<inlineCode parentName=\"p\">{`LoadBalancer`}</inlineCode>{`, EKS will create a:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Classic Load Balancer by default.`}</li>\n      <li parentName=\"ul\">{`Netword Load Balancer if this is specified: `}<inlineCode parentName=\"li\">{`service.beta.kubernetes.io/aws-load-balancer-type:nlb`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`There is also support for internal load balancers: `}<inlineCode parentName=\"li\">{`service.beta.kubernetes.io//aws-load-balancer-internal:0.0.0.0/0`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`You can control the configuration of LBs using annotations in your manifest.`}</li>\n      <li parentName=\"ul\">{`All documentation for `}<inlineCode parentName=\"li\">{`LoadBalancer`}</inlineCode>{` on AWS is diretly on the Kubernetes project.`}</li>\n      <li parentName=\"ul\">{`ALB Ingress is open source and found on GitHub.`}</li>\n      <li parentName=\"ul\">{`Supports target group of instance mode (hooked into NodePort).`}</li>\n      <li parentName=\"ul\">{`Supports target group of IP mode (directly communicating with the pod).`}</li>\n      <li parentName=\"ul\">{`Supports Application Load Balancer listener rules.`}</li>\n    </ul>\n    </MDXLayout>;\n}\n\nMDXContent.isMDXComponent = true;\n  "],"sourceRoot":""}