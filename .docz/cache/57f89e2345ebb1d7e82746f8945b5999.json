{"remainingRequest":"/Users/okeeffe_d/Business/Documentation/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"/Users/okeeffe_d/Business/Documentation/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[[\"/Users/okeeffe_d/Business/Documentation/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}]],\"babelrc\":false,\"cacheCompression\":true,\"compact\":true}!/Users/okeeffe_d/Business/Documentation/manual/React-Notes/Advanced-React-Redux.md","dependencies":[{"path":"/Users/okeeffe_d/Business/Documentation/manual/React-Notes/Advanced-React-Redux.md","mtime":1548209344435},{"path":"/Users/okeeffe_d/Business/Documentation/node_modules/cache-loader/dist/cjs.js","mtime":1548134640245},{"path":"/Users/okeeffe_d/Business/Documentation/node_modules/babel-loader/lib/index.js","mtime":1548134640227}],"contextDependencies":[],"result":["function _typeof(obj){if(typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj;};}return _typeof(obj);}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)===\"object\"||typeof call===\"function\")){return call;}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return self;}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function\");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}import React from'react';import{MDXTag}from'@mdx-js/tag';var MDXContent=/*#__PURE__*/function(_React$Component){_inherits(MDXContent,_React$Component);function MDXContent(props){var _this;_classCallCheck(this,MDXContent);_this=_possibleConstructorReturn(this,_getPrototypeOf(MDXContent).call(this,props));_this.layout=null;return _this;}_createClass(MDXContent,[{key:\"render\",value:function render(){var _this$props=this.props,components=_this$props.components,props=_objectWithoutProperties(_this$props,[\"components\"]);return React.createElement(MDXTag,{name:\"wrapper\",components:components},React.createElement(MDXTag,{name:\"h1\",components:components,props:{\"id\":\"advanced-react-and-redux\"}},\"Advanced React and Redux\"),React.createElement(MDXTag,{name:\"ul\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#advanced-react-and-redux\"}},\"Advanced React and Redux\"),React.createElement(MDXTag,{name:\"ul\",components:components,parentName:\"li\"},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#1-testing\"}},\"1. Testing\"),React.createElement(MDXTag,{name:\"ul\",components:components,parentName:\"li\"},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#test-reporting\"}},\"Test Reporting\")))),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#3-higher-order-components\"}},\"3. Higher Order Components\"),React.createElement(MDXTag,{name:\"ul\",components:components,parentName:\"li\"},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#require-auth-hoc\"}},\"Require Auth HOC\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#nesting-higher-order-components\"}},\"Nesting Higher Order Components\")))),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#3-middlewares\"}},\"3. Middlewares\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#4-authentication\"}},\"4. Authentication\"),React.createElement(MDXTag,{name:\"ul\",components:components,parentName:\"li\"},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#cookies-vs-tokens\"}},\"Cookies vs Tokens\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#scalable-architecture\"}},\"Scalable Architecture\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#server-setup\"}},\"Server Setup\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#express-middleware\"}},\"Express Middleware\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#seeing-the-mongodb-database\"}},\"Seeing the MongoDB Database\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#authentication-controller\"}},\"Authentication Controller\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#jwt-overview\"}},\"JWT Overview\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#passport\"}},\"Passport\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#using-strategies-with-passport\"}},\"Using Strategies with Passport\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#using-postman\"}},\"Using Postman\")))),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#client-side-react-app\"}},\"Client Side (React App)\"),React.createElement(MDXTag,{name:\"ul\",components:components,parentName:\"li\"},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#dealing-with-cors-errors-with-a-request-cors-in-a-nutshell\"}},\"Dealing with CORS errors with a request (CORS in a nutshell)\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#local-storage-on-the-client-and-jwt\"}},\"Local storage on the client and JWT\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#form-vaidation\"}},\"Form vaidation\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#signup-action-creator\"}},\"Signup Action Creator\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#checking-auth-at-the-start-of-the-application\"}},\"Checking auth at the start of the application\")),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},React.createElement(MDXTag,{name:\"a\",components:components,parentName:\"li\",props:{\"href\":\"#making-authenticated-api-requests\"}},\"Making Authenticated API Requests\"))))))),React.createElement(MDXTag,{name:\"h2\",components:components,props:{\"id\":\"1-testing\"}},\"1. Testing\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Jumping into examples are normally more useful as you are learning.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"testing\"),\" folder you will see a whole bunch of configuration for \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"test_helper.js\"),\".\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"test-reporting\"}},\"Test Reporting\"),React.createElement(MDXTag,{name:\"h2\",components:components,props:{\"id\":\"3-higher-order-components\"}},\"3. Higher Order Components\"),React.createElement(MDXTag,{name:\"p\",components:components},\"What are they? Chances are you've already been using them.\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"HOC + Component = Component + Additional functionality & Data\")),React.createElement(MDXTag,{name:\"p\",components:components},\"This gives us back an \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"enchanced/composed\"),\" componenet. These are heavily used in library like \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"React-Redux\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Connect and Provider\")),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"import { connect } from 'react-redux';\\n\\nclass App extends Component {\\n    ...\\n}\\n\\nfunction mapStateToProps(state) {\\n    return { posts: state.props };\\n}\\n\\n// connect is the HOC that wraps mapStateToProps\\nexport default connect(mapStateToProps)(App);\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"How about the Provider?\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// in index.js or whatever ReactDOM we're using\\nReactDOM.render(\\n    <Provider store={createStoreWithMiddleware(reducers)}>\\n        <App />\\n    </Provider>,\\n    document.querySelector('.container')\\n);\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"The \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Provider\"),\" is a HOC to the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Redux Store\"),\". Whenever the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Redux Store\"),\" changing, the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Provider\"),\" notices and broadcasts down to any connected component (using the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"connect\"),\" function).\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"require-auth-hoc\"}},\"Require Auth HOC\"),React.createElement(MDXTag,{name:\"p\",components:components},\"How can we use a HOC to help with authentication?\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"import React from 'react';\\n\\nexport default () => {\\n    return (\\n        <div>\\n            Super Special Secret Recipe\\n            <ul>\\n                <li class=\\\"example\\\">1 Cup Sugar</li>\\n                <li class=\\\"example\\\">1 Cup Salt</li>\\n                <li class=\\\"example\\\">Another piece of stuff</li>\\n            </ul>\\n        </div>\\n    );\\n};\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"If we pass this basic component to the router, we can wrap the component using a HOC.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"You need to create \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"actions\"),\" and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"reducers\"),\" for the correct Auth action and reducer.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// src > actions > index.js\\n// doesn't include the reducer code\\nimport { CHANGE_AUTH } from './types';\\n\\nexport function authenticate(isLoggedIn) {\\n    return {\\n        type: CHANGE_AUTH,\\n        payload: isLoggedIn\\n    };\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Building the Higher Order Component\")),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// src > components > requireAuth.js\\n\\nimport React, { Component } from 'react';\\n\\nexport default function(ComposedComponent) {\\n    class Authentication extends Component {\\n        render() {\\n            return <ComposedComponent {...this.props} />;\\n        }\\n    }\\n\\n    return Authentication;\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"em\",components:components,parentName:\"p\"},\"What's going on here?\")),React.createElement(MDXTag,{name:\"p\",components:components},\"In some other location, we want to use this HOC.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"eg. another render method\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{}},\"import Authentication\\nimport Resources // the component to wrap\\n\\nconst ComposedComponent = Authentication(Resources);\\n\\n...\\n\\nrender() {\\n    <ComposedComponent resources={resourceList} />\\n}\\n\\n// OR MORE USEFULLY IN THE REACT ROUTER\\n\\n<Route path=\\\"/\\\" component={Authentication(Resources)} />\\n\")),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"nesting-higher-order-components\"}},\"Nesting Higher Order Components\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Building the above component with Redux and the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"connect\"),\" HOC.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// src > components > requireAuth.js\\n\\nimport React, { Component } from 'react';\\nimport { connect } from 'react-redux';\\n\\nexport default function(ComposedComponent) {\\n    class Authentication extends Component {\\n        // to get data ahead of time\\n        // this is part of \\\"Class Level Properties\\\"\\n        // console.log(this.context) will show nav properties!\\n        static contextTypes = {\\n            router: React.PropTypes.object\\n        };\\n\\n        render() {\\n            return <ComposedComponent {...this.props} />;\\n        }\\n    }\\n\\n    function mapStateToProps(state) {\\n        return { authenticated: state.authenticated };\\n    }\\n\\n    return connect(mapStateToProps)(Authentication);\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"static\"),\" will create a \\\"Class Level Property\\\" and this gives other instances access to \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Authentication.contextTypes\"),\".\"),React.createElement(MDXTag,{name:\"h2\",components:components,props:{\"id\":\"3-middlewares\"}},\"3. Middlewares\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In the React-Redux cycle, the action is sent to the middleware before it forwards that onto the reducers.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Middleware has the opportunity to log, stop, modify or not touch an action.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"export default function({dispatch}) {\\n    return next => action => {\\n        console.log(action);\\n\\n        next(action);\\n    }\\n}\\n\\n// vanilla es5\\nexport default function({dispatch}) {\\n    return function(next) {\\n        return function(action) {\\n            console.log(action);\\n\\n            next(action);\\n        }\\n    }\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Now with this \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"async\"),\", we can apply it to the main file where \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"createStoreWithMiddleware\"),\" lives through \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"applyMiddleware(Example)(createStore)\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"It's important that we just target the actions that we want - send the others on using the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"next()\"),\" function.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"export default function({ dispatch }) {\\n    return (next) => (action) => {\\n        if (!action.payload || !action.payload.then) {\\n            return next(action);\\n        }\\n\\n        // if there is a promise\\n        action.payload.then((response) => {\\n            // knock off and replace response\\n            const newAction = { ...action, payload: response };\\n            dispatch(newAction);\\n        });\\n    };\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"So why do a new dispatch instead of using next? It's to do with the chain that we have. We want to ensure it goes back through the entire chain again. We want the middleware to be oblivious to what is happening.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"If we want to add more middleware into the mix, we just add them as further parameters into the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"applyMiddleware\"),\" function.\"),React.createElement(MDXTag,{name:\"h2\",components:components,props:{\"id\":\"4-authentication\"}},\"4. Authentication\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Not a lot of great end-to-end tutorials already. Most skip some important steps.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Best React backend? There is no best backend. All they care about is being served JSON.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Work on the relationship of have a \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Username/Password\"),\" combination and being authenticated by the server. After being authenticated, we want them to be able to make post requests without reidentifying. The server must give the client back something for this part.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In conclusion, we just want \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Here is my cookie OR token for a protected resource\"),\".\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"cookies-vs-tokens\"}},\"Cookies vs Tokens\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Cookies\")),React.createElement(MDXTag,{name:\"ul\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Automatically included on all requests\"),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Unique to each domain\"),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Cannot be sent to different domains\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Headers - \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"cookie: {}\"),\"\\nBody - JSON\"),React.createElement(MDXTag,{name:\"p\",components:components},\"The point of cookies is to bring \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"state\"),\" to something \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"stateless\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Token\")),React.createElement(MDXTag,{name:\"ul\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Have to manually wire up\"),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Can be sent to any domain\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Headers - \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"authorization: jioeajteioa\"),\"\\nBody - JSON\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Being able to send this to any domain we wish is a benefit with a token.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"scalable-architecture\"}},\"Scalable Architecture\"),React.createElement(MDXTag,{name:\"p\",components:components},\"So we've decided to go with tokens, which is also aligned with how the industry is trending.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"If we served \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"index.html\"),\" and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"bundle.js\"),\" from a Content Server, we can make that server work with no auth req'd.\"),React.createElement(MDXTag,{name:\"ul\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Very easy to redistribute\")),React.createElement(MDXTag,{name:\"p\",components:components},\"If we had our API server on another server, we would use a token because cookies would not be able to access the domain with the cookie. It also means we could keep a single location for both mobile and web application.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"This set up also means that we can had different developers working on different projects.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"That way, scaling also makes it easier! If we need to load balance the API servers because we are using more than just one device, then this allows us to also be more effective in scaling out an API.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"server-setup\"}},\"Server Setup\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Time to start writing some code.\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"mkdir server && cd server\")),React.createElement(MDXTag,{name:\"p\",components:components},\"An example \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"package.json\"),\" will look like so\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"{\\n  \\\"name\\\": \\\"server\\\",\\n  \\\"version\\\": \\\"1.0.0\\\",\\n  \\\"description\\\": \\\"\\\",\\n  \\\"main\\\": \\\"index.js\\\",\\n  \\\"scripts\\\": {\\n    \\\"test\\\": \\\"echo \\\"Error: no test specified\\\" && exit 1\\\",\\n    \\\"dev\\\": \\\"nodemon index.js\\\"\\n  },\\n  \\\"author\\\": \\\"\\\",\\n  \\\"license\\\": \\\"ISC\\\",\\n  \\\"dependencies\\\": {\\n    \\\"bcrypt-nodejs\\\": \\\"0.0.3\\\",\\n    \\\"body-parser\\\": \\\"^1.15.0\\\",\\n    \\\"cors\\\": \\\"^2.7.1\\\",\\n    \\\"express\\\": \\\"^4.13.4\\\",\\n    \\\"jwt-simple\\\": \\\"^0.5.0\\\",\\n    \\\"mongoose\\\": \\\"^4.4.7\\\",\\n    \\\"morgan\\\": \\\"^1.7.0\\\",\\n    \\\"nodemon\\\": \\\"^1.9.1\\\",\\n    \\\"passport\\\": \\\"^0.3.2\\\",\\n    \\\"passport-jwt\\\": \\\"^2.0.0\\\",\\n    \\\"passport-local\\\": \\\"^1.0.0\\\"\\n  }\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Refer to Github to see more info on each of these packages.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Touch \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"index.js\"),\" and that will be the entry point for the server.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// Main starting point of the application\\nconst express = require('express');\\nconst http = require('http');\\nconst bodyParser = require('body-parser');\\nconst morgan = require('morgan');\\nconst app = express();\\nconst router = require('./router');\\nconst mongoose = require('mongoose');\\nconst cors = require('cors');\\n\\n// DB Setup\\nmongoose.connect('mongodb://localhost:auth/auth');\\n\\n// App Setup\\napp.use(morgan('combined'));\\napp.use(cors());\\napp.use(bodyParser.json({ type: '*/*' }));\\nrouter(app);\\n\\n// Server Setup\\nconst port = process.env.PORT || 3090;\\nconst server = http.createServer(app);\\nserver.listen(port);\\nconsole.log('Server listening on:', port);\\n\")),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"express-middleware\"}},\"Express Middleware\"),React.createElement(MDXTag,{name:\"p\",components:components},\"The following lines are part of the middleware:\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// App Setup\\napp.use(morgan('combined'));\\napp.use(cors());\\napp.use(bodyParser.json({ type: '*/*' }));\\nrouter(app);\\n\")),React.createElement(MDXTag,{name:\"ul\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Morgan is a logging framework - quite good for giving the type of requests!\"),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"Cors allows you the server to use Cross Origin.\"),React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ul\"},\"bodyParser will parse incoming requests. At the moment, it's just for JSON but you may need to change this if you are expecting a file etc.\")),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"seeing-the-mongodb-database\"}},\"Seeing the MongoDB Database\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Worthwhile downloading \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Robomongo\"),\" if you are keen to visually see a GUI with MongoDB.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"authentication-controller\"}},\"Authentication Controller\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In the server, we can create some controllers eg. \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"controllers/authentication.js\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Each controller will be responsible for handling a type of response.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"router.js\"),\", we can use the functions exported from the controller to create routes that will deal with post routes.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"jwt-overview\"}},\"JWT Overview\"),React.createElement(MDXTag,{name:\"p\",components:components},\"There are two phases for the lifecycle.\"),React.createElement(MDXTag,{name:\"ol\",components:components},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ol\"},\"When signing in\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"User ID\"),\" + \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Secret String\"),\" = \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"JSON Web Token\")),React.createElement(MDXTag,{name:\"p\",components:components},\"In the future, the user can now use this token for future requests.\"),React.createElement(MDXTag,{name:\"ol\",components:components,props:{\"start\":2}},React.createElement(MDXTag,{name:\"li\",components:components,parentName:\"ol\"},\"Authenticated calls after signin\")),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"JSON Web Token\"),\" + \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Secret String\"),\" = \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"User ID\")),React.createElement(MDXTag,{name:\"p\",components:components},\"If the \\\"secret string\\\" is incorrect, then this will not result in the User ID. Must keep the secret 100% secret!\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Building the JTW\")),React.createElement(MDXTag,{name:\"p\",components:components},\"We can use the library \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"jtw-simple\"),\". In the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"config.js\"),\" file at the root of the app, we can hold the application secrets and config. Ensure these files are \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\".gitigore\"),\"'d.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"const jwt = require('jwt-simple');\\nconst config = require('../config');\\n\\nfunction tokenForUser(user) {\\n    const timestamp = new Date().getTime();\\n    // convention will have sub for subject, iat for issued at time\\n    return jwt.encode({ sub: user.id, iat: timestamp }, config.secret);\\n}\\n\")),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"passport\"}},\"Passport\"),React.createElement(MDXTag,{name:\"p\",components:components},\"So once they've signed up, how do we exchange and give them a token? We need to handle the login case. We also need to make sure they're authenticated when they try accessing a protected resource.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"For example, if we have a \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Posts\"),\" or \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Comments\"),\" controller, we need to check if they've been loggin in and if they have a valid token.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"To do it, we can use \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"passport.js\"),\" - it's normally used for cookie based auth but we can use it with JWT tokens. First, install \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"passport\"),\" and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"passport-jwt\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Then, we can build \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"service/passport.js\"),\" file.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"const passport = require('passport');\\nconst User = require('../models/user');\\nconst config = require('../config');\\nconst JwtStrategy = require('passport-jwt').Strategy;\\nconst ExtractJwt = require('passport-jwt').ExtractJwt;\\nconst LocalStrategy = require('passport-local');\\n\\n// Create local strategy\\nconst localOptions = { usernameField: 'email' };\\nconst localLogin = new LocalStrategy(localOptions, function(\\n    email,\\n    password,\\n    done\\n) {\\n    // Verify this email and password, call done with the user\\n    // if it is the correct email and password\\n    // otherwise, call done with false\\n    User.findOne({ email: email }, function(err, user) {\\n        if (err) {\\n            return done(err);\\n        }\\n        if (!user) {\\n            return done(null, false);\\n        }\\n\\n        // compare passwords - is `password` equal to user.password?\\n        user.comparePassword(password, function(err, isMatch) {\\n            if (err) {\\n                return done(err);\\n            }\\n            if (!isMatch) {\\n                return done(null, false);\\n            }\\n\\n            return done(null, user);\\n        });\\n    });\\n});\\n\\n// Setup options for JWT Strategy\\nconst jwtOptions = {\\n    jwtFromRequest: ExtractJwt.fromHeader('authorization'),\\n    secretOrKey: config.secret\\n};\\n\\n// Create JWT strategy\\nconst jwtLogin = new JwtStrategy(jwtOptions, function(payload, done) {\\n    // See if the user ID in the payload exists in our database\\n    // If it does, call 'done' with that other\\n    // otherwise, call done without a user object\\n    User.findById(payload.sub, function(err, user) {\\n        if (err) {\\n            return done(err, false);\\n        }\\n\\n        if (user) {\\n            done(null, user);\\n        } else {\\n            done(null, false);\\n        }\\n    });\\n});\\n\\n// Tell passport to use this strategy\\npassport.use(jwtLogin);\\npassport.use(localLogin);\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Passport is more of an ecosystem of strategies. A strategy is a method for authenticating a user.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In the Jwt Strategy, the payload comes from the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"sub\"),\" and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"iat\"),\" we created.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"using-strategies-with-passport\"}},\"Using Strategies with Passport\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Reminder: Stategies are a plugin of sorts that works with Passport.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"For the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"jwtOptions\"),\", there is a little bit of action going. If we look at the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"payload\"),\" parameter for jwtLogin, we know it somehow gets these options as an argument, but the token can be sitting anywhere, so how do we know? We pass \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"jwtFromRequest\"),\" to let them know where to look eg \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"jwtFromRequest: ExtractJwt.fromHeader('authorization')\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"We then let them know that the we wish to use the option \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"secretOrKey\"),\" which will be \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"config.secret\"),\" in this case \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"secretOrKey: config.secret\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"As a final step, we tell passport to use the straight with the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\".use()\"),\" method.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"We also need to build a very particular route to use passport. In the router file, first import the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"passportService\"),\" from \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"services/passport\"),\" and require the passport lib into routes as well.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"The, we can create an authentication \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"const requireAuth = passport.authenticate('jwt', { session: false });\"),\" - session false is because we do not want to use a cookie.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"const Authentication = require('./controllers/authentication');\\nconst passportService = require('./services/passport');\\nconst passport = require('passport');\\n\\nconst requireAuth = passport.authenticate('jwt', { session: false });\\nconst requireSignin = passport.authenticate('local', { session: false });\\n\\nmodule.exports = function(app) {\\n    // here we wish to actually use require auth as middleware\\n    // before processing\\n    app.get('/', requireAuth, function(req, res) {\\n        res.send({ message: 'Super secret code is ABC123' });\\n    });\\n    app.post('/signin', requireSignin, Authentication.signin);\\n    app.post('/signup', Authentication.signup);\\n};\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Using \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Postman\"),\", we can then make a \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"signup\"),\" attempt, grab the token and then try make a get request to \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"/\"),\". If we add a header \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"authorization\"),\" and add in the token we get, we can see that we will get success. Changing this token slightly will give you an unauthorized response.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In contrast, if we want to run something like a signin, we would start by installing the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"passport-local\"),\" \\\"plugin\\\" for passport.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"We then create a local strategy. We need to specifically tell the local strategy where to look. If we're using email then we would write something like \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"const localOptions = { usernameField: 'email' };\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Local Strategy vs JWT Strategy\")),React.createElement(MDXTag,{name:\"p\",components:components},\"Why there difference? Signing up requires signing in and returning a token.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"If they are signing in however, we verify that the username and password are correct and then we give them a token.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Then, in the future, when they wish to make a request, we verify the token and give them access to whatever the resouce they want is.\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"strong\",components:components,parentName:\"p\"},\"Bcrypt and Signing in\")),React.createElement(MDXTag,{name:\"p\",components:components},\"If we then need to use the schema defined \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"comparePassword\"),\" method.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"using-postman\"}},\"Using Postman\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Whenever you are willing to test the server using postman, startup the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"mongod\"),\" daemon (if using mongo) and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"nodemon index.js\"),\" on the server file, and then you can make GET and POST requests to the localhost port.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"If signing up, add a body of JSON to the data.\"),React.createElement(MDXTag,{name:\"h2\",components:components,props:{\"id\":\"client-side-react-app\"}},\"Client Side (React App)\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In a form handler, we use an Action Creator.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"Usually, there has been a singular flow for an action, however we are now sitting in a situation where you may have to handle what happens when signing in has a rejection.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"If correct, return the JWT token, else show an error message.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"What we can do is use \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Redux Thunk\"),\" to help achieve the behaviour of dealing with a good or bad request. Redux thunk allows us to return a function from an \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Action\"),\" instead of just an object, and we can pass a \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"dispatch\"),\" parameter and what we can then do is any async function etc. and then allowing arbitrary access to the dispatch at anytime we want - that way we can pass a whole ton of logic of what we want to do.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"For the action creator itself, we then want to pass a constant of the server URL to make the post request - this can be done using \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"axios\"),\"!\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"dealing-with-cors-errors-with-a-request-cors-in-a-nutshell\"}},\"Dealing with CORS errors with a request (CORS in a nutshell)\"),React.createElement(MDXTag,{name:\"p\",components:components},\"How to deal with a CORS No Access-Control-Allow-Origin - it's essentially a security protocol.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In an example of how it works, a AJAX request from \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"google.com\"),\" to \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"google.com\"),\" with the same domain, subdomain and port matching means that the request is okay, but trying to do it from \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"google.com\"),\" to \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"github.com\"),\" as an example won't match and the request is denied unless the server allows it to happen.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"This wasn't an issue with \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Postman\"),\" because enforcing CORS will need either the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Host\"),\" or \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Origin\"),\" header which is trivially easy to fake.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"So, how do we deal with this? What we actually do is to change our server to handle all subdomains - this is a common approach for all API servers. The idea is that you want anyone from anywhere to be able to access your server.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"We can use \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"cors\"),\" on the server to help with this. We will just use \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"app.use(cors());\"),\".\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"local-storage-on-the-client-and-jwt\"}},\"Local storage on the client and JWT\"),React.createElement(MDXTag,{name:\"p\",components:components},\"The idea with the JWT token is to save that and be able to use it. Having the JWT in local storage, it also means that it is persistent and available again for a user once they come back.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"form-vaidation\"}},\"Form vaidation\"),React.createElement(MDXTag,{name:\"p\",components:components},React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"redux-validation\"),\" can really help us out here!\"),React.createElement(MDXTag,{name:\"p\",components:components},\"With a form, create a function \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"validate()\"),\" that will take the \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"formProps\"),\" and return any errors.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"function validate(formProps) {\\n    const errors = {};\\n\\n    console.log(formProps); // this would be linked up to the email, password and passwordConfirm\\n\\n    // do this for each field\\n    if (!formProps.email) {\\n        errors.email = 'Please enter an email';\\n    }\\n\\n    if (formProps.password !== formProps.passwordConfirm) {\\n        errors.password = 'Passwords must match';\\n    }\\n\\n    return errors;\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"You can then set \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"{password.touched && password.error && <div className=\\\"error\\\">{password.error}</div>}\"),\" for the error to show on the component.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"signup-action-creator\"}},\"Signup Action Creator\"),React.createElement(MDXTag,{name:\"p\",components:components},\"For the form component, create an action handler for \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"onSubmit\"),\" with \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"<form onSubmit={handleSubmit(this.handleFormSubmit.bind(this))}\"),\".\"),React.createElement(MDXTag,{name:\"p\",components:components},\"In order to protect routes from being accessed without authentication, we use Higher Order Components in order to wrap other components.\"),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"checking-auth-at-the-start-of-the-application\"}},\"Checking auth at the start of the application\"),React.createElement(MDXTag,{name:\"p\",components:components},\"With we use redux and \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"createStoreWithMiddleware(reducers)\"),\", we can start applying some intricate details.\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"// create a store ahead of time\\nconst store = createStoreWithMiddleware(reducers);\\nconst token = localStorage.getItem('token');\\n// if we have a token, consider the user to be signed in\\nif (token) {\\n    // we need to update application state - the dispatch method\\n    // any action can be sent off in the dispatch\\n    store.dispatch({\\n        // make sure you import AUTH_USER first\\n        type: AUTH_USER\\n    });\\n}\\n\")),React.createElement(MDXTag,{name:\"h3\",components:components,props:{\"id\":\"making-authenticated-api-requests\"}},\"Making Authenticated API Requests\"),React.createElement(MDXTag,{name:\"p\",components:components},\"How do we make sure a User can make an authenticated request after signing in?\"),React.createElement(MDXTag,{name:\"p\",components:components},\"With a \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Redux Thunk\"),\" dispatch function, we can make a authenticated request.\"),React.createElement(MDXTag,{name:\"p\",components:components},\"With Axios, we can make an auth request like so:\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"export function fetchMessage() {\\n    return function(dispatch) {\\n        axios\\n            .get(ROOT_URL, {\\n                headers: { authorization: localStorage.getItem('token') }\\n            })\\n            .then((response) => {\\n                console.log(response);\\n                dispatch({\\n                    type: TYPE,\\n                    payload: response.data.message\\n                });\\n            });\\n    };\\n}\\n\")),React.createElement(MDXTag,{name:\"p\",components:components},\"This can also be done with \",React.createElement(MDXTag,{name:\"inlineCode\",components:components,parentName:\"p\"},\"Redux Promise\"),\" in such a clean way:\"),React.createElement(MDXTag,{name:\"pre\",components:components},React.createElement(MDXTag,{name:\"code\",components:components,parentName:\"pre\",props:{\"className\":\"language-javascript\"}},\"export function fetchMessage() {\\n    const request = axios.get(ROOT_URL, {\\n        headers: { authorization: localStorage.getItem('token') }\\n    });\\n\\n    return {\\n        type: TYPE,\\n        payload: response.data.message\\n    };\\n}\\n\")));}}]);return MDXContent;}(React.Component);export{MDXContent as default};MDXContent.__docgenInfo={\"description\":\"\",\"methods\":[],\"displayName\":\"MDXContent\"};",{"version":3,"sources":["/Users/okeeffe_d/Business/Documentation/manual/React-Notes/Advanced-React-Redux.md"],"names":["React","MDXTag","MDXContent","props","layout","components","Component"],"mappings":"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","sourcesContent":["\n  import React from 'react'\n  import { MDXTag } from '@mdx-js/tag'\n  \n\nexport default class MDXContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.layout = null\n  }\n  render() {\n    const { components, ...props } = this.props\n\n    return <MDXTag\n             name=\"wrapper\"\n             \n             components={components}><MDXTag name=\"h1\" components={components} props={{\"id\":\"advanced-react-and-redux\"}}>{`Advanced React and Redux`}</MDXTag>\n{/* TOC */}\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#advanced-react-and-redux\"}}>{`Advanced React and Redux`}</MDXTag><MDXTag name=\"ul\" components={components} parentName=\"li\">\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#1-testing\"}}>{`1. Testing`}</MDXTag><MDXTag name=\"ul\" components={components} parentName=\"li\">\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#test-reporting\"}}>{`Test Reporting`}</MDXTag></MDXTag>\n</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#3-higher-order-components\"}}>{`3. Higher Order Components`}</MDXTag><MDXTag name=\"ul\" components={components} parentName=\"li\">\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#require-auth-hoc\"}}>{`Require Auth HOC`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#nesting-higher-order-components\"}}>{`Nesting Higher Order Components`}</MDXTag></MDXTag>\n</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#3-middlewares\"}}>{`3. Middlewares`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#4-authentication\"}}>{`4. Authentication`}</MDXTag><MDXTag name=\"ul\" components={components} parentName=\"li\">\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#cookies-vs-tokens\"}}>{`Cookies vs Tokens`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#scalable-architecture\"}}>{`Scalable Architecture`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#server-setup\"}}>{`Server Setup`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#express-middleware\"}}>{`Express Middleware`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#seeing-the-mongodb-database\"}}>{`Seeing the MongoDB Database`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#authentication-controller\"}}>{`Authentication Controller`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#jwt-overview\"}}>{`JWT Overview`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#passport\"}}>{`Passport`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#using-strategies-with-passport\"}}>{`Using Strategies with Passport`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#using-postman\"}}>{`Using Postman`}</MDXTag></MDXTag>\n</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#client-side-react-app\"}}>{`Client Side (React App)`}</MDXTag><MDXTag name=\"ul\" components={components} parentName=\"li\">\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#dealing-with-cors-errors-with-a-request-cors-in-a-nutshell\"}}>{`Dealing with CORS errors with a request (CORS in a nutshell)`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#local-storage-on-the-client-and-jwt\"}}>{`Local storage on the client and JWT`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#form-vaidation\"}}>{`Form vaidation`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#signup-action-creator\"}}>{`Signup Action Creator`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#checking-auth-at-the-start-of-the-application\"}}>{`Checking auth at the start of the application`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\"><MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"#making-authenticated-api-requests\"}}>{`Making Authenticated API Requests`}</MDXTag></MDXTag>\n</MDXTag></MDXTag>\n</MDXTag></MDXTag>\n</MDXTag>\n{/* /TOC */}\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"1-testing\"}}>{`1. Testing`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Jumping into examples are normally more useful as you are learning.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`testing`}</MDXTag>{` folder you will see a whole bunch of configuration for `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`test_helper.js`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"test-reporting\"}}>{`Test Reporting`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"3-higher-order-components\"}}>{`3. Higher Order Components`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`What are they? Chances are you've already been using them.`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`HOC + Component = Component + Additional functionality & Data`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`This gives us back an `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`enchanced/composed`}</MDXTag>{` componenet. These are heavily used in library like `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`React-Redux`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Connect and Provider`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`import { connect } from 'react-redux';\n\nclass App extends Component {\n    ...\n}\n\nfunction mapStateToProps(state) {\n    return { posts: state.props };\n}\n\n// connect is the HOC that wraps mapStateToProps\nexport default connect(mapStateToProps)(App);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`How about the Provider?`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// in index.js or whatever ReactDOM we're using\nReactDOM.render(\n    <Provider store={createStoreWithMiddleware(reducers)}>\n        <App />\n    </Provider>,\n    document.querySelector('.container')\n);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`The `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Provider`}</MDXTag>{` is a HOC to the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Redux Store`}</MDXTag>{`. Whenever the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Redux Store`}</MDXTag>{` changing, the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Provider`}</MDXTag>{` notices and broadcasts down to any connected component (using the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`connect`}</MDXTag>{` function).`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"require-auth-hoc\"}}>{`Require Auth HOC`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`How can we use a HOC to help with authentication?`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`import React from 'react';\n\nexport default () => {\n    return (\n        <div>\n            Super Special Secret Recipe\n            <ul>\n                <li class=\"example\">1 Cup Sugar</li>\n                <li class=\"example\">1 Cup Salt</li>\n                <li class=\"example\">Another piece of stuff</li>\n            </ul>\n        </div>\n    );\n};\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`If we pass this basic component to the router, we can wrap the component using a HOC.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`You need to create `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`actions`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`reducers`}</MDXTag>{` for the correct Auth action and reducer.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// src > actions > index.js\n// doesn't include the reducer code\nimport { CHANGE_AUTH } from './types';\n\nexport function authenticate(isLoggedIn) {\n    return {\n        type: CHANGE_AUTH,\n        payload: isLoggedIn\n    };\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Building the Higher Order Component`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// src > components > requireAuth.js\n\nimport React, { Component } from 'react';\n\nexport default function(ComposedComponent) {\n    class Authentication extends Component {\n        render() {\n            return <ComposedComponent {...this.props} />;\n        }\n    }\n\n    return Authentication;\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"em\" components={components} parentName=\"p\">{`What's going on here?`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`In some other location, we want to use this HOC.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`eg. another render method`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{}}>{`import Authentication\nimport Resources // the component to wrap\n\nconst ComposedComponent = Authentication(Resources);\n\n...\n\nrender() {\n    <ComposedComponent resources={resourceList} />\n}\n\n// OR MORE USEFULLY IN THE REACT ROUTER\n\n<Route path=\"/\" component={Authentication(Resources)} />\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"nesting-higher-order-components\"}}>{`Nesting Higher Order Components`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Building the above component with Redux and the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`connect`}</MDXTag>{` HOC.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// src > components > requireAuth.js\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nexport default function(ComposedComponent) {\n    class Authentication extends Component {\n        // to get data ahead of time\n        // this is part of \"Class Level Properties\"\n        // console.log(this.context) will show nav properties!\n        static contextTypes = {\n            router: React.PropTypes.object\n        };\n\n        render() {\n            return <ComposedComponent {...this.props} />;\n        }\n    }\n\n    function mapStateToProps(state) {\n        return { authenticated: state.authenticated };\n    }\n\n    return connect(mapStateToProps)(Authentication);\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`static`}</MDXTag>{` will create a \"Class Level Property\" and this gives other instances access to `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Authentication.contextTypes`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"3-middlewares\"}}>{`3. Middlewares`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In the React-Redux cycle, the action is sent to the middleware before it forwards that onto the reducers.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Middleware has the opportunity to log, stop, modify or not touch an action.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`export default function({dispatch}) {\n    return next => action => {\n        console.log(action);\n\n        next(action);\n    }\n}\n\n// vanilla es5\nexport default function({dispatch}) {\n    return function(next) {\n        return function(action) {\n            console.log(action);\n\n            next(action);\n        }\n    }\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Now with this `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`async`}</MDXTag>{`, we can apply it to the main file where `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`createStoreWithMiddleware`}</MDXTag>{` lives through `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`applyMiddleware(Example)(createStore)`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`It's important that we just target the actions that we want - send the others on using the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`next()`}</MDXTag>{` function.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`export default function({ dispatch }) {\n    return (next) => (action) => {\n        if (!action.payload || !action.payload.then) {\n            return next(action);\n        }\n\n        // if there is a promise\n        action.payload.then((response) => {\n            // knock off and replace response\n            const newAction = { ...action, payload: response };\n            dispatch(newAction);\n        });\n    };\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`So why do a new dispatch instead of using next? It's to do with the chain that we have. We want to ensure it goes back through the entire chain again. We want the middleware to be oblivious to what is happening.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If we want to add more middleware into the mix, we just add them as further parameters into the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`applyMiddleware`}</MDXTag>{` function.`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"4-authentication\"}}>{`4. Authentication`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Not a lot of great end-to-end tutorials already. Most skip some important steps.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Best React backend? There is no best backend. All they care about is being served JSON.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Work on the relationship of have a `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Username/Password`}</MDXTag>{` combination and being authenticated by the server. After being authenticated, we want them to be able to make post requests without reidentifying. The server must give the client back something for this part.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In conclusion, we just want `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Here is my cookie OR token for a protected resource`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"cookies-vs-tokens\"}}>{`Cookies vs Tokens`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Cookies`}</MDXTag></MDXTag>\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Automatically included on all requests`}</MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Unique to each domain`}</MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Cannot be sent to different domains`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Headers - `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`cookie: {}`}</MDXTag>{`\nBody - JSON`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The point of cookies is to bring `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`state`}</MDXTag>{` to something `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`stateless`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Token`}</MDXTag></MDXTag>\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Have to manually wire up`}</MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Can be sent to any domain`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Headers - `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`authorization: jioeajteioa`}</MDXTag>{`\nBody - JSON`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Being able to send this to any domain we wish is a benefit with a token.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"scalable-architecture\"}}>{`Scalable Architecture`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`So we've decided to go with tokens, which is also aligned with how the industry is trending.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If we served `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`index.html`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`bundle.js`}</MDXTag>{` from a Content Server, we can make that server work with no auth req'd.`}</MDXTag>\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Very easy to redistribute`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If we had our API server on another server, we would use a token because cookies would not be able to access the domain with the cookie. It also means we could keep a single location for both mobile and web application.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`This set up also means that we can had different developers working on different projects.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`That way, scaling also makes it easier! If we need to load balance the API servers because we are using more than just one device, then this allows us to also be more effective in scaling out an API.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"server-setup\"}}>{`Server Setup`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Time to start writing some code.`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`mkdir server && cd server`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`An example `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`package.json`}</MDXTag>{` will look like so`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`{\n  \"name\": \"server\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\",\n    \"dev\": \"nodemon index.js\"\n  },\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"bcrypt-nodejs\": \"0.0.3\",\n    \"body-parser\": \"^1.15.0\",\n    \"cors\": \"^2.7.1\",\n    \"express\": \"^4.13.4\",\n    \"jwt-simple\": \"^0.5.0\",\n    \"mongoose\": \"^4.4.7\",\n    \"morgan\": \"^1.7.0\",\n    \"nodemon\": \"^1.9.1\",\n    \"passport\": \"^0.3.2\",\n    \"passport-jwt\": \"^2.0.0\",\n    \"passport-local\": \"^1.0.0\"\n  }\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Refer to Github to see more info on each of these packages.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Touch `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`index.js`}</MDXTag>{` and that will be the entry point for the server.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// Main starting point of the application\nconst express = require('express');\nconst http = require('http');\nconst bodyParser = require('body-parser');\nconst morgan = require('morgan');\nconst app = express();\nconst router = require('./router');\nconst mongoose = require('mongoose');\nconst cors = require('cors');\n\n// DB Setup\nmongoose.connect('mongodb://localhost:auth/auth');\n\n// App Setup\napp.use(morgan('combined'));\napp.use(cors());\napp.use(bodyParser.json({ type: '*/*' }));\nrouter(app);\n\n// Server Setup\nconst port = process.env.PORT || 3090;\nconst server = http.createServer(app);\nserver.listen(port);\nconsole.log('Server listening on:', port);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"express-middleware\"}}>{`Express Middleware`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The following lines are part of the middleware:`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// App Setup\napp.use(morgan('combined'));\napp.use(cors());\napp.use(bodyParser.json({ type: '*/*' }));\nrouter(app);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Morgan is a logging framework - quite good for giving the type of requests!`}</MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Cors allows you the server to use Cross Origin.`}</MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`bodyParser will parse incoming requests. At the moment, it's just for JSON but you may need to change this if you are expecting a file etc.`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"seeing-the-mongodb-database\"}}>{`Seeing the MongoDB Database`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Worthwhile downloading `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Robomongo`}</MDXTag>{` if you are keen to visually see a GUI with MongoDB.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"authentication-controller\"}}>{`Authentication Controller`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In the server, we can create some controllers eg. `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`controllers/authentication.js`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Each controller will be responsible for handling a type of response.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`router.js`}</MDXTag>{`, we can use the functions exported from the controller to create routes that will deal with post routes.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"jwt-overview\"}}>{`JWT Overview`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`There are two phases for the lifecycle.`}</MDXTag>\n<MDXTag name=\"ol\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ol\">{`When signing in`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`User ID`}</MDXTag>{` + `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Secret String`}</MDXTag>{` = `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`JSON Web Token`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`In the future, the user can now use this token for future requests.`}</MDXTag>\n<MDXTag name=\"ol\" components={components} props={{\"start\":2}}>\n<MDXTag name=\"li\" components={components} parentName=\"ol\">{`Authenticated calls after signin`}</MDXTag>\n</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`JSON Web Token`}</MDXTag>{` + `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Secret String`}</MDXTag>{` = `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`User ID`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`If the \"secret string\" is incorrect, then this will not result in the User ID. Must keep the secret 100% secret!`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Building the JTW`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`We can use the library `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`jtw-simple`}</MDXTag>{`. In the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`config.js`}</MDXTag>{` file at the root of the app, we can hold the application secrets and config. Ensure these files are `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.gitigore`}</MDXTag>{`'d.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`const jwt = require('jwt-simple');\nconst config = require('../config');\n\nfunction tokenForUser(user) {\n    const timestamp = new Date().getTime();\n    // convention will have sub for subject, iat for issued at time\n    return jwt.encode({ sub: user.id, iat: timestamp }, config.secret);\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"passport\"}}>{`Passport`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`So once they've signed up, how do we exchange and give them a token? We need to handle the login case. We also need to make sure they're authenticated when they try accessing a protected resource.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`For example, if we have a `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Posts`}</MDXTag>{` or `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Comments`}</MDXTag>{` controller, we need to check if they've been loggin in and if they have a valid token.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`To do it, we can use `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`passport.js`}</MDXTag>{` - it's normally used for cookie based auth but we can use it with JWT tokens. First, install `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`passport`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`passport-jwt`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Then, we can build `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`service/passport.js`}</MDXTag>{` file.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`const passport = require('passport');\nconst User = require('../models/user');\nconst config = require('../config');\nconst JwtStrategy = require('passport-jwt').Strategy;\nconst ExtractJwt = require('passport-jwt').ExtractJwt;\nconst LocalStrategy = require('passport-local');\n\n// Create local strategy\nconst localOptions = { usernameField: 'email' };\nconst localLogin = new LocalStrategy(localOptions, function(\n    email,\n    password,\n    done\n) {\n    // Verify this email and password, call done with the user\n    // if it is the correct email and password\n    // otherwise, call done with false\n    User.findOne({ email: email }, function(err, user) {\n        if (err) {\n            return done(err);\n        }\n        if (!user) {\n            return done(null, false);\n        }\n\n        // compare passwords - is \\`password\\` equal to user.password?\n        user.comparePassword(password, function(err, isMatch) {\n            if (err) {\n                return done(err);\n            }\n            if (!isMatch) {\n                return done(null, false);\n            }\n\n            return done(null, user);\n        });\n    });\n});\n\n// Setup options for JWT Strategy\nconst jwtOptions = {\n    jwtFromRequest: ExtractJwt.fromHeader('authorization'),\n    secretOrKey: config.secret\n};\n\n// Create JWT strategy\nconst jwtLogin = new JwtStrategy(jwtOptions, function(payload, done) {\n    // See if the user ID in the payload exists in our database\n    // If it does, call 'done' with that other\n    // otherwise, call done without a user object\n    User.findById(payload.sub, function(err, user) {\n        if (err) {\n            return done(err, false);\n        }\n\n        if (user) {\n            done(null, user);\n        } else {\n            done(null, false);\n        }\n    });\n});\n\n// Tell passport to use this strategy\npassport.use(jwtLogin);\npassport.use(localLogin);\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Passport is more of an ecosystem of strategies. A strategy is a method for authenticating a user.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In the Jwt Strategy, the payload comes from the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`sub`}</MDXTag>{` and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`iat`}</MDXTag>{` we created.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"using-strategies-with-passport\"}}>{`Using Strategies with Passport`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Reminder: Stategies are a plugin of sorts that works with Passport.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`For the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`jwtOptions`}</MDXTag>{`, there is a little bit of action going. If we look at the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`payload`}</MDXTag>{` parameter for jwtLogin, we know it somehow gets these options as an argument, but the token can be sitting anywhere, so how do we know? We pass `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`jwtFromRequest`}</MDXTag>{` to let them know where to look eg `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`jwtFromRequest: ExtractJwt.fromHeader('authorization')`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`We then let them know that the we wish to use the option `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`secretOrKey`}</MDXTag>{` which will be `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`config.secret`}</MDXTag>{` in this case `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`secretOrKey: config.secret`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`As a final step, we tell passport to use the straight with the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`.use()`}</MDXTag>{` method.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`We also need to build a very particular route to use passport. In the router file, first import the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`passportService`}</MDXTag>{` from `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`services/passport`}</MDXTag>{` and require the passport lib into routes as well.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The, we can create an authentication `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`const requireAuth = passport.authenticate('jwt', { session: false });`}</MDXTag>{` - session false is because we do not want to use a cookie.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`const Authentication = require('./controllers/authentication');\nconst passportService = require('./services/passport');\nconst passport = require('passport');\n\nconst requireAuth = passport.authenticate('jwt', { session: false });\nconst requireSignin = passport.authenticate('local', { session: false });\n\nmodule.exports = function(app) {\n    // here we wish to actually use require auth as middleware\n    // before processing\n    app.get('/', requireAuth, function(req, res) {\n        res.send({ message: 'Super secret code is ABC123' });\n    });\n    app.post('/signin', requireSignin, Authentication.signin);\n    app.post('/signup', Authentication.signup);\n};\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Using `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Postman`}</MDXTag>{`, we can then make a `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`signup`}</MDXTag>{` attempt, grab the token and then try make a get request to `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`/`}</MDXTag>{`. If we add a header `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`authorization`}</MDXTag>{` and add in the token we get, we can see that we will get success. Changing this token slightly will give you an unauthorized response.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In contrast, if we want to run something like a signin, we would start by installing the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`passport-local`}</MDXTag>{` \"plugin\" for passport.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`We then create a local strategy. We need to specifically tell the local strategy where to look. If we're using email then we would write something like `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`const localOptions = { usernameField: 'email' };`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Local Strategy vs JWT Strategy`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Why there difference? Signing up requires signing in and returning a token.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If they are signing in however, we verify that the username and password are correct and then we give them a token.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Then, in the future, when they wish to make a request, we verify the token and give them access to whatever the resouce they want is.`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"strong\" components={components} parentName=\"p\">{`Bcrypt and Signing in`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`If we then need to use the schema defined `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`comparePassword`}</MDXTag>{` method.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"using-postman\"}}>{`Using Postman`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Whenever you are willing to test the server using postman, startup the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`mongod`}</MDXTag>{` daemon (if using mongo) and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`nodemon index.js`}</MDXTag>{` on the server file, and then you can make GET and POST requests to the localhost port.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If signing up, add a body of JSON to the data.`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"client-side-react-app\"}}>{`Client Side (React App)`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In a form handler, we use an Action Creator.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Usually, there has been a singular flow for an action, however we are now sitting in a situation where you may have to handle what happens when signing in has a rejection.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`If correct, return the JWT token, else show an error message.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`What we can do is use `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Redux Thunk`}</MDXTag>{` to help achieve the behaviour of dealing with a good or bad request. Redux thunk allows us to return a function from an `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Action`}</MDXTag>{` instead of just an object, and we can pass a `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`dispatch`}</MDXTag>{` parameter and what we can then do is any async function etc. and then allowing arbitrary access to the dispatch at anytime we want - that way we can pass a whole ton of logic of what we want to do.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`For the action creator itself, we then want to pass a constant of the server URL to make the post request - this can be done using `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`axios`}</MDXTag>{`!`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"dealing-with-cors-errors-with-a-request-cors-in-a-nutshell\"}}>{`Dealing with CORS errors with a request (CORS in a nutshell)`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`How to deal with a CORS No Access-Control-Allow-Origin - it's essentially a security protocol.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In an example of how it works, a AJAX request from `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`google.com`}</MDXTag>{` to `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`google.com`}</MDXTag>{` with the same domain, subdomain and port matching means that the request is okay, but trying to do it from `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`google.com`}</MDXTag>{` to `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`github.com`}</MDXTag>{` as an example won't match and the request is denied unless the server allows it to happen.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`This wasn't an issue with `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Postman`}</MDXTag>{` because enforcing CORS will need either the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Host`}</MDXTag>{` or `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Origin`}</MDXTag>{` header which is trivially easy to fake.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`So, how do we deal with this? What we actually do is to change our server to handle all subdomains - this is a common approach for all API servers. The idea is that you want anyone from anywhere to be able to access your server.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`We can use `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`cors`}</MDXTag>{` on the server to help with this. We will just use `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`app.use(cors());`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"local-storage-on-the-client-and-jwt\"}}>{`Local storage on the client and JWT`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`The idea with the JWT token is to save that and be able to use it. Having the JWT in local storage, it also means that it is persistent and available again for a user once they come back.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"form-vaidation\"}}>{`Form vaidation`}</MDXTag>\n<MDXTag name=\"p\" components={components}><MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`redux-validation`}</MDXTag>{` can really help us out here!`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`With a form, create a function `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`validate()`}</MDXTag>{` that will take the `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`formProps`}</MDXTag>{` and return any errors.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`function validate(formProps) {\n    const errors = {};\n\n    console.log(formProps); // this would be linked up to the email, password and passwordConfirm\n\n    // do this for each field\n    if (!formProps.email) {\n        errors.email = 'Please enter an email';\n    }\n\n    if (formProps.password !== formProps.passwordConfirm) {\n        errors.password = 'Passwords must match';\n    }\n\n    return errors;\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`You can then set `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`{password.touched && password.error && <div className=\"error\">{password.error}</div>}`}</MDXTag>{` for the error to show on the component.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"signup-action-creator\"}}>{`Signup Action Creator`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`For the form component, create an action handler for `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`onSubmit`}</MDXTag>{` with `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`<form onSubmit={handleSubmit(this.handleFormSubmit.bind(this))}`}</MDXTag>{`.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`In order to protect routes from being accessed without authentication, we use Higher Order Components in order to wrap other components.`}</MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"checking-auth-at-the-start-of-the-application\"}}>{`Checking auth at the start of the application`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`With we use redux and `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`createStoreWithMiddleware(reducers)`}</MDXTag>{`, we can start applying some intricate details.`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`// create a store ahead of time\nconst store = createStoreWithMiddleware(reducers);\nconst token = localStorage.getItem('token');\n// if we have a token, consider the user to be signed in\nif (token) {\n    // we need to update application state - the dispatch method\n    // any action can be sent off in the dispatch\n    store.dispatch({\n        // make sure you import AUTH_USER first\n        type: AUTH_USER\n    });\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h3\" components={components} props={{\"id\":\"making-authenticated-api-requests\"}}>{`Making Authenticated API Requests`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`How do we make sure a User can make an authenticated request after signing in?`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`With a `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Redux Thunk`}</MDXTag>{` dispatch function, we can make a authenticated request.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`With Axios, we can make an auth request like so:`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`export function fetchMessage() {\n    return function(dispatch) {\n        axios\n            .get(ROOT_URL, {\n                headers: { authorization: localStorage.getItem('token') }\n            })\n            .then((response) => {\n                console.log(response);\n                dispatch({\n                    type: TYPE,\n                    payload: response.data.message\n                });\n            });\n    };\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`This can also be done with `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`Redux Promise`}</MDXTag>{` in such a clean way:`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-javascript\"}}>{`export function fetchMessage() {\n    const request = axios.get(ROOT_URL, {\n        headers: { authorization: localStorage.getItem('token') }\n    });\n\n    return {\n        type: TYPE,\n        payload: response.data.message\n    };\n}\n`}</MDXTag></MDXTag>\n           </MDXTag>\n  }\n}\n  "]}]}